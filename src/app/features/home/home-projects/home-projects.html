<section class="container mx-auto px-5 lg:px-20 py-20 min-h-200 section-pattern section-pattern-left relative">
  <!-- Skeleton Loader -->
  @if (isLoading()) {
  <div class="flex justify-start mb-20 min-h-15">
    <p-skeleton width="200px" height="40px" styleClass="rounded-lg"></p-skeleton>
  </div>

  <!-- Desktop Skeleton -->
  <div class="hidden lg:flex flex-col gap-10 relative min-h-[80vh] pt-30 lg:mx-30 my-10">
    @for (i of [1,2,3]; track i) {
    <div class="absolute flex justify-between items-center rounded-3xl p-8 px-10 min-h-75 w-full">
      <p-skeleton width="25%" height="300px" styleClass="rounded-lg"></p-skeleton>
      <div class="w-3/4 flex flex-col gap-4">
        <p-skeleton width="60%" height="30px" styleClass="rounded-lg"></p-skeleton>
        <p-skeleton width="80%" height="40px" styleClass="rounded-lg"></p-skeleton>
        <p-skeleton width="100%" height="100px" styleClass="rounded-lg"></p-skeleton>
        <p-skeleton width="200px" height="30px" styleClass="rounded-lg"></p-skeleton>
      </div>
    </div>
    }
  </div>

  <!-- Mobile Skeleton -->
  <div class="flex lg:hidden flex-col gap-6 my-10 min-h-150">
    @for (i of [1,2,3]; track i) {
    <div class="flex flex-col md:flex-row justify-between items-center rounded-3xl p-6 bg-white shadow-lg min-h-50">
      <p-skeleton width="200px" height="200px" styleClass="rounded-lg"></p-skeleton>
      <div class="w-full md:w-3/4 p-4 flex flex-col gap-4">
        <p-skeleton width="60%" height="24px" styleClass="rounded-lg"></p-skeleton>
        <p-skeleton width="80%" height="28px" styleClass="rounded-lg"></p-skeleton>
        <p-skeleton width="100%" height="80px" styleClass="rounded-lg"></p-skeleton>
        <p-skeleton width="180px" height="24px" styleClass="rounded-lg"></p-skeleton>
      </div>
    </div>
    }
  </div>

  <div class="flex justify-center mt-20">
    <p-skeleton width="200px" height="50px" styleClass="rounded-full"></p-skeleton>
  </div>
  } @else {
  <app-section-title [title]="projectsTitle" customClass="flex justify-start mb-20 min-h-[60px]">
  </app-section-title>
  <!-- Desktop: Cards with animations stacked -->
  <div class="hidden lg:flex flex-col gap-10 relative lg:h-162.5 pt-30 lg:mx-30 mt-10 ">
    @for (project of projects().slice(0, 3); track project.slug; let i = $index) {
    <div #projectCard
      class="project-card absolute flex justify-between items-center rounded-3xl p-8 px-10 transition-all duration-300 cursor-pointer min-h-75"
      [class]="i === 0 ? '-rotate-4 -translate-y-20 bg-gray-200' : i === 1 ? 'active-card bg-white shadow-lg' : 'rotate-4 translate-y-20 bg-gray-100'"
      (click)="onCardClick(i)">
      <div class="w-1/4 p-5 xl:p-10 ">
        <img [ngSrc]="getResponsiveImage(project.image) || '/images/placeholder.webp'" [alt]="project.title || ''"
          width="300" height="300" class="w-62.5 h-57.5 xl:w-100 xl:h-75  object-cover ">
      </div>
      <div class="h-full w-3/4 p-5 xl:p-10 min-h-75">
        <h2 class="text-xl text-[#636363] font-medium mb-6">{{ project.category_name }}</h2>
        <h3 class="text-xl font-bold text-[#440000] mb-6">{{ project.title }}</h3>
        <p class="mb-12 text-xs xl:text-lg font-medium text-[#440000] line-clamp-3">{{ project.text }}</p>
        <span class="underline text-[#ED2924] fill-[#ED2924] font-semibold text-xl flex items-center justify-center">عرض
          تفاصيل
          المشروع
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="22" height="22"
            class="mx-1 size-3.5 md:size-4.5">
            <path
              d="M201.4 297.4C188.9 309.9 188.9 330.2 201.4 342.7L361.4 502.7C373.9 515.2 394.2 515.2 406.7 502.7C419.2 490.2 419.2 469.9 406.7 457.4L269.3 320L406.6 182.6C419.1 170.1 419.1 149.8 406.6 137.3C394.1 124.8 373.8 124.8 361.3 137.3L201.3 297.3z" />
          </svg>
        </span>
      </div>
    </div>
    }
  </div>

  <!-- Mobile: Cards stacked normally -->
  <div class="flex lg:hidden flex-col gap-6 my-10 mb-10 pb-10">
    @for (project of projects().slice(0, 3); track project.slug; let i = $index) {
    <div
      class="project-card-mobile flex flex-col md:flex-row justify-between items-center rounded-3xl p-6 bg-white shadow-lg min-h-50"
      (click)="onCardClick(i)">
      <div class="w-full md:w-1/4 p-4 flex justify-center min-h-50 min-w-50">
        <img [ngSrc]="getResponsiveImage(project.image) || '/images/placeholder.webp'" [alt]="project.title || ''"
          width="300" height="300" class="w-full max-w-50 md:max-w-62.5 h-50 object-cover">
      </div>
      <div class="w-full md:w-3/4 p-4 min-h-50">
        <h2 class="text-lg md:text-xl text-[#636363] font-medium mb-4">{{ project.category_name }}</h2>
        <h3 class="text-lg md:text-xl font-bold text-[#440000] mb-4">{{ project.title }}</h3>
        <p class="mb-6 text-xs xl:text-lg font-medium text-[#440000] line-clamp-3">{{ project.text }}</p>
        <span
          class="underline text-[#ED2924] font-semibold text-lg flex items-center justify-center md:justify-start">عرض
          تفاصيل
          المشروع
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="22" height="22"
            class="mx-1 size-3.5 md:size-4.5">
            <path
              d="M201.4 297.4C188.9 309.9 188.9 330.2 201.4 342.7L361.4 502.7C373.9 515.2 394.2 515.2 406.7 502.7C419.2 490.2 419.2 469.9 406.7 457.4L269.3 320L406.6 182.6C419.1 170.1 419.1 149.8 406.6 137.3C394.1 124.8 373.8 124.8 361.3 137.3L201.3 297.3z" />
          </svg>
        </span>
      </div>
    </div>
    }
  </div>
  <!-- } -->

  <div class="w-full relative z-20 flex justify-center pt-10 xl:pt-20">
    <app-app-button [btnText]="btnText" routerLink="/المشاريع"
      customClass="ps-7 pe-3 py-4 bg-[#B91C17] text-white rounded-full flex items-center justify-center transition duration-300 cursor-pointer shadow-lg hover:bg-[#940000]">
    </app-app-button>
  </div>
  }
</section>