<!-- Main content wrapper with min-height to prevent footer from appearing at top -->
<div class="min-h-screen">
    @if (bannerSection()) {
    <app-hero-section [title]="bannerSection()?.title || ''" [paragraph]="bannerSection()?.text || ''"
        customClass=" h-[90vh] lg:h-[80vh]!"
        [image]="bannerSection()?.image ? getResponsiveImage(bannerSection()?.image) : undefined"
        [imagePosition]="bannerSection()?.image ? 'left' : 'none'"
        imageClass=" absolute -bottom-[0px]! -left-[0px]! lg:-left-[0px]!">
    </app-hero-section>
    } @else {
    <!-- Hero Section Skeleton -->
    <section class="bg-linear min-h-[90vh] lg:min-h-[80vh] relative flex items-center">
        <div class="container mx-auto px-5 lg:px-20 hero-skeleton">
            <p-skeleton width="60%" height="50px" styleClass="rounded-lg mb-4"></p-skeleton>
            <p-skeleton width="80%" height="30px" styleClass="rounded-lg"></p-skeleton>
        </div>
    </section>
    }

    <section class="container mx-auto px-5 lg:px-20 py-12 md:py-20 relative">

        @if (projectItems().length > 0) {
        <div class="projects-grid grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
            @for (project of projectItems(); track project.id) {
            <div class="project-card cursor-pointer " (click)="navigateToProjectDetails(project)">
                <!-- Project Image -->
                <div class="project-image mb-4">
                    <img loading="lazy" decoding="async" [src]="getResponsiveImage(project.image)" [alt]="project.title"
                        class="w-full h-75 rounded-2xl object-cover"
                        (error)="$event.target.src = '/images/project.webp'">
                </div>

                <!-- Project Tags -->
                @if (project.types && project.types.length > 0) {
                <div class="project-tags flex flex-wrap gap-2 mb-3">
                    @for (type of project.types; track type) {
                    <span class="project-tag bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm">
                        {{ type }}
                    </span>
                    }
                </div>
                }

                <!-- Project Title -->
                <h3 class="text-xl md:text-2xl font-bold text-[#440000] mb-2 line-clamp-1" [title]="project.title">
                    {{ project.title }}
                </h3>

                <!-- Project Brief -->
                @if (project.brief) {
                <p class="project-brief text-base text-[#440000] leading-relaxed">
                    {{ project.brief }}
                </p>
                }
            </div>
            }
        </div>
        } @else {
        <div class="text-center py-12">
            <p class="text-xl text-gray-500">لا توجد مشاريع متاحة</p>
        </div>
        }

        <!-- Pagination -->
        @if (projects() && totalRecords() > 0) {
        <div class="flex justify-center mt-12 md:mt-16" dir="ltr">
            <p-paginator [first]="first()" [rows]="rows()" [totalRecords]="totalRecords()"
                (onPageChange)="onPageChange($event)" styleClass="custom-paginator">
            </p-paginator>
        </div>
        }
        <!-- </div> -->


        <!-- </div> -->
    </section>

    @defer (when isAllDataLoaded()) {
    <app-contact-us-sec></app-contact-us-sec>
    } @placeholder {
    <!-- Contact Section Skeleton -->
    <section class="container mx-auto px-5 lg:px-20 py-20 min-h-150">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-stretch min-h-150">
            <!-- Right Side - Contact Form Skeleton -->
            <div class="flex flex-col h-full min-h-150">
                <p-skeleton width="200px" height="40px" styleClass="rounded-lg mb-4"></p-skeleton>
                <p-skeleton width="80%" height="30px" styleClass="rounded-lg mb-8"></p-skeleton>
                <div class="flex flex-col gap-6 flex-1">
                    <p-skeleton width="100%" height="60px" styleClass="rounded-lg"></p-skeleton>
                    <p-skeleton width="100%" height="60px" styleClass="rounded-lg"></p-skeleton>
                    <p-skeleton width="100%" height="60px" styleClass="rounded-lg"></p-skeleton>
                    <p-skeleton width="100%" height="150px" styleClass="rounded-lg"></p-skeleton>
                    <p-skeleton width="200px" height="50px" styleClass="rounded-full mt-4"></p-skeleton>
                </div>
            </div>
            <!-- Left Side - Map Skeleton -->
            <div class="h-full rounded-2xl overflow-hidden min-h-150">
                <p-skeleton width="100%" height="600px" styleClass="rounded-2xl"></p-skeleton>
            </div>
        </div>
    </section>
    }
</div>